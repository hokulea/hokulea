import { getRootElement, focus } from '@ember/test-helpers';
import { testListboxForKeyboardMultiSelection, testListboxForKeyboardSingleSelection, testListboxForMouseSingleSelection, testListboxForMouseMultiSelection, testListboxKeyboardNavigation, testListboxMouseNavigation } from '@hokulea/ember-controls/test-support/a11y/-private/listbox';
const DEFAULT_SELECTORS = {
    trigger: '[role="listbox"]',
    list: '[role="listbox"]',
    option: '[role="option"]'
};
function setupListTest(assert, selectors) {
    const fullSelectors = { ...DEFAULT_SELECTORS, ...selectors };
    const list = getRootElement().querySelector(selectors.list);
    const trigger = getRootElement().querySelector(selectors.trigger);
    assert.dom(list).exists('list exists');
    return {
        elements: {
            trigger: trigger,
            list: list
        },
        selectors: fullSelectors
    };
}
//
// KEYBOARD
//
export async function testListKeyboardNavigation(assert, selectors = DEFAULT_SELECTORS) {
    const { elements, selectors: allSelectors } = setupListTest(assert, selectors);
    const { trigger, list } = elements;
    await focus(list);
    await testListboxKeyboardNavigation(assert, {
        target: trigger,
        list
    }, {
        option: allSelectors.option
    });
}
async function testListForKeyboardSingleSelection(assert, elements, selectors) {
    const { trigger, list } = elements;
    await focus(list);
    await testListboxForKeyboardSingleSelection(assert, {
        target: trigger,
        list
    }, {
        option: selectors.option
    });
}
async function testListForKeyboardMultiSelection(assert, elements, selectors) {
    const { trigger, list } = elements;
    await focus(list);
    await testListboxForKeyboardMultiSelection(assert, {
        target: trigger,
        list
    }, {
        option: selectors.option
    });
}
export async function testListKeyboardSelection(assert, selectors = DEFAULT_SELECTORS) {
    const { elements, selectors: allSelectors } = setupListTest(assert, selectors);
    const multi = elements.list.getAttribute('aria-multiselectable');
    await (multi
        ? testListForKeyboardMultiSelection(assert, elements, allSelectors)
        : testListForKeyboardSingleSelection(assert, elements, allSelectors));
}
//
// MOUSE
//
export async function testListMouseNavigation(assert, selectors = DEFAULT_SELECTORS) {
    const { elements, selectors: allSelectors } = setupListTest(assert, selectors);
    const { list } = elements;
    await testListboxMouseNavigation(assert, {
        list
    }, {
        option: allSelectors.option
    });
}
async function testListForMouseSingleSelection(assert, elements, selectors) {
    const { trigger, list } = elements;
    await testListboxForMouseSingleSelection(assert, {
        target: trigger,
        list
    }, {
        option: selectors.option
    });
}
async function testListForMouseMultiSelection(assert, elements, selectors) {
    const { trigger, list } = elements;
    await testListboxForMouseMultiSelection(assert, {
        target: trigger,
        list
    }, {
        option: selectors.option
    });
}
export async function testListMouseSelection(assert, selectors = DEFAULT_SELECTORS) {
    const { elements, selectors: allSelectors } = setupListTest(assert, selectors);
    const multi = elements.list.getAttribute('aria-multiselectable');
    await (multi
        ? testListForMouseMultiSelection(assert, elements, allSelectors)
        : testListForMouseSingleSelection(assert, elements, allSelectors));
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImxpc3QudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGNBQWMsRUFBRSxLQUFLLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUU1RCxPQUFPLEVBQ0wsb0NBQW9DLEVBQ3BDLHFDQUFxQyxFQUNyQyxrQ0FBa0MsRUFDbEMsaUNBQWlDLEVBQ2pDLDZCQUE2QixFQUM3QiwwQkFBMEIsRUFDM0IsTUFBTSw0REFBNEQsQ0FBQztBQWFwRSxNQUFNLGlCQUFpQixHQUFHO0lBQ3hCLE9BQU8sRUFBRSxrQkFBa0I7SUFDM0IsSUFBSSxFQUFFLGtCQUFrQjtJQUN4QixNQUFNLEVBQUUsaUJBQWlCO0NBQzFCLENBQUM7QUFFRixTQUFTLGFBQWEsQ0FDcEIsTUFBYyxFQUNkLFNBQTZCO0lBRTdCLE1BQU0sYUFBYSxHQUFHLEVBQUUsR0FBRyxpQkFBaUIsRUFBRSxHQUFHLFNBQVMsRUFBRSxDQUFDO0lBQzdELE1BQU0sSUFBSSxHQUFHLGNBQWMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxTQUFTLENBQUMsSUFBYyxDQUFDLENBQUM7SUFDdEUsTUFBTSxPQUFPLEdBQUcsY0FBYyxFQUFFLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxPQUFpQixDQUFDLENBQUM7SUFFNUUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUM7SUFFdkMsT0FBTztRQUNMLFFBQVEsRUFBRTtZQUNSLE9BQU8sRUFBRSxPQUFzQjtZQUMvQixJQUFJLEVBQUUsSUFBbUI7U0FDMUI7UUFDRCxTQUFTLEVBQUUsYUFBYTtLQUN6QixDQUFDO0FBQ0osQ0FBQztBQUVELEVBQUU7QUFDRixXQUFXO0FBQ1gsRUFBRTtBQUVGLE1BQU0sQ0FBQyxLQUFLLFVBQVUsMEJBQTBCLENBQzlDLE1BQWMsRUFDZCxZQUFnQyxpQkFBaUI7SUFFakQsTUFBTSxFQUFFLFFBQVEsRUFBRSxT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a0IsRUFDbEIsU0FBb0I7SUFFcEIsTUFBTSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUUsR0FBRyxRQUFRLENBQUM7SUFDbkMsTUFBTSxpQ0FBaUMsQ0FDckMsTUFBTSxFQUNOO1FBQ0UsTUFBTSxFQUFFLE9BQU87UUFDZixJQUFJO0tBQ0wsRUFDRDtRQUNFLE1BQU0sRUFBRSxTQUFTLENBQUMsTUFBTTtLQUN6QixDQUNGLENBQUM7QUFDSixDQUFDO0FBRUQsTUFBTSxDQUFDLEtBQUssVUFBVSxzQkFBc0IsQ0FDMUMsTUFBYyxFQUNkLFlBQWdDLGlCQUFpQjtJQUVqRCxNQUFNLEVBQUUsUUFBUSxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUUsR0FBRyxhQUFhLENBQ3pELE1BQU0sRUFDTixTQUFTLENBQ1YsQ0FBQztJQUNGLE1BQU0sS0FBSyxHQUFHLFFBQVEsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLHNCQUFzQixDQUFDLENBQUM7SUFFakUsTUFBTSxDQUFDLEtBQUs7UUFDVixDQUFDLENBQUMsOEJBQThCLENBQUMsTUFBTSxFQUFFLFFBQVEsRUFBRSxZQUFZLENBQUM7UUFDaEUsQ0FBQyxDQUFDLCtCQUErQixDQUFDLE1BQU0sRUFBRSxRQUFRLEVBQUUsWUFBWSxDQUFDLENBQUMsQ0FBQztBQUN2RSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0Um9vdEVsZW1lbnQsIGZvY3VzIH0gZnJvbSAnQGVtYmVyL3Rlc3QtaGVscGVycyc7XG5cbmltcG9ydCB7XG4gIHRlc3RMaXN0Ym94Rm9yS2V5Ym9hcmRNdWx0aVNlbGVjdGlvbixcbiAgdGVzdExpc3Rib3hGb3JLZXlib2FyZFNpbmdsZVNlbGVjdGlvbixcbiAgdGVzdExpc3Rib3hGb3JNb3VzZVNpbmdsZVNlbGVjdGlvbixcbiAgdGVzdExpc3Rib3hGb3JNb3VzZU11bHRpU2VsZWN0aW9uLFxuICB0ZXN0TGlzdGJveEtleWJvYXJkTmF2aWdhdGlvbixcbiAgdGVzdExpc3Rib3hNb3VzZU5hdmlnYXRpb25cbn0gZnJvbSAnQGhva3VsZWEvZW1iZXItY29udHJvbHMvdGVzdC1zdXBwb3J0L2ExMXkvLXByaXZhdGUvbGlzdGJveCc7XG5cbnR5cGUgU2VsZWN0b3JzID0ge1xuICB0cmlnZ2VyOiBzdHJpbmc7XG4gIGxpc3Q6IHN0cmluZztcbiAgb3B0aW9uOiBzdHJpbmc7XG59O1xuXG50eXBlIEVsZW1lbnRzID0ge1xuICB0cmlnZ2VyOiBIVE1MRWxlbWVudDtcbiAgbGlzdDogSFRNTEVsZW1lbnQ7XG59O1xuXG5jb25zdCBERUZBVUxUX1NFTEVDVE9SUyA9IHtcbiAgdHJpZ2dlcjogJ1tyb2xlPVwibGlzdGJveFwiXScsXG4gIGxpc3Q6ICdbcm9sZT1cImxpc3Rib3hcIl0nLFxuICBvcHRpb246ICdbcm9sZT1cIm9wdGlvblwiXSdcbn07XG5cbmZ1bmN0aW9uIHNldHVwTGlzdFRlc3QoXG4gIGFzc2VydDogQXNzZXJ0LFxuICBzZWxlY3RvcnM6IFBhcnRpYWw8U2VsZWN0b3JzPlxuKTogeyBlbGVtZW50czogRWxlbWVudHM7IHNlbGVjdG9yczogU2VsZWN0b3JzIH0ge1xuICBjb25zdCBmdWxsU2VsZWN0b3JzID0geyAuLi5ERUZBVUxUX1NFTEVDVE9SUywgLi4uc2VsZWN0b3JzIH07XG4gIGNvbnN0IGxpc3QgPSBnZXRSb290RWxlbWVudCgpLnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3JzLmxpc3QgYXMgc3RyaW5nKTtcbiAgY29uc3QgdHJpZ2dlciA9IGdldFJvb3RFbGVtZW50KCkucXVlcnlTZWxlY3RvcihzZWxlY3RvcnMudHJpZ2dlciBhcyBzdHJpbmcpO1xuXG4gIGFzc2VydC5kb20obGlzdCkuZXhpc3RzKCdsaXN0IGV4aXN0cycpO1xuXG4gIHJldHVybiB7XG4gICAgZWxlbWVudHM6IHtcbiAgICAgIHRyaWdnZXI6IHRyaWdnZXIgYXMgSFRNTEVsZW1lbnQsXG4gICAgICBsaXN0OiBsaXN0IGFzIEhUTUxFbGVtZW50XG4gICAgfSxcbiAgICBzZWxlY3RvcnM6IGZ1bGxTZWxlY3RvcnNcbiAgfTtcbn1cblxuLy9cbi8vIEtFWUJPQVJEXG4vL1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGVzdExpc3RLZXlib2FyZE5hdmlnYXRpb24oXG4gIGFzc2VydDogQXNzZXJ0LFxuICBzZWxlY3RvcnM6IFBhcnRpYWw8U2VsZWN0b3JzPiA9IERFRkFVTFRfU0VMRUNUT1JTXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgeyBlbGVtZW50cywgc2VsZWN0b3JzOiBhbGxTZWxlY3RvcnMgfSA9IHNldHVwTGlzdFRlc3QoXG4gICAgYXNzZXJ0LFxuICAgIHNlbGVjdG9yc1xuICApO1xuXG4gIGNvbnN0IHsgdHJpZ2dlciwgbGlzdCB9ID0gZWxlbWVudHM7XG4gIGF3YWl0IGZvY3VzKGxpc3QpO1xuXG4gIGF3YWl0IHRlc3RMaXN0Ym94S2V5Ym9hcmROYXZpZ2F0aW9uKFxuICAgIGFzc2VydCxcbiAgICB7XG4gICAgICB0YXJnZXQ6IHRyaWdnZXIsXG4gICAgICBsaXN0XG4gICAgfSxcbiAgICB7XG4gICAgICBvcHRpb246IGFsbFNlbGVjdG9ycy5vcHRpb25cbiAgICB9XG4gICk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHRlc3RMaXN0Rm9yS2V5Ym9hcmRTaW5nbGVTZWxlY3Rpb24oXG4gIGFzc2VydDogQXNzZXJ0LFxuICBlbGVtZW50czogRWxlbWVudHMsXG4gIHNlbGVjdG9yczogU2VsZWN0b3JzXG4pIHtcbiAgY29uc3QgeyB0cmlnZ2VyLCBsaXN0IH0gPSBlbGVtZW50cztcbiAgYXdhaXQgZm9jdXMobGlzdCk7XG4gIGF3YWl0IHRlc3RMaXN0Ym94Rm9yS2V5Ym9hcmRTaW5nbGVTZWxlY3Rpb24oXG4gICAgYXNzZXJ0LFxuICAgIHtcbiAgICAgIHRhcmdldDogdHJpZ2dlcixcbiAgICAgIGxpc3RcbiAgICB9LFxuICAgIHtcbiAgICAgIG9wdGlvbjogc2VsZWN0b3JzLm9wdGlvblxuICAgIH1cbiAgKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gdGVzdExpc3RGb3JLZXlib2FyZE11bHRpU2VsZWN0aW9uKFxuICBhc3NlcnQ6IEFzc2VydCxcbiAgZWxlbWVudHM6IEVsZW1lbnRzLFxuICBzZWxlY3RvcnM6IFNlbGVjdG9yc1xuKSB7XG4gIGNvbnN0IHsgdHJpZ2dlciwgbGlzdCB9ID0gZWxlbWVudHM7XG4gIGF3YWl0IGZvY3VzKGxpc3QpO1xuICBhd2FpdCB0ZXN0TGlzdGJveEZvcktleWJvYXJkTXVsdGlTZWxlY3Rpb24oXG4gICAgYXNzZXJ0LFxuICAgIHtcbiAgICAgIHRhcmdldDogdHJpZ2dlcixcbiAgICAgIGxpc3RcbiAgICB9LFxuICAgIHtcbiAgICAgIG9wdGlvbjogc2VsZWN0b3JzLm9wdGlvblxuICAgIH1cbiAgKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRlc3RMaXN0S2V5Ym9hcmRTZWxlY3Rpb24oXG4gIGFzc2VydDogQXNzZXJ0LFxuICBzZWxlY3RvcnM6IFBhcnRpYWw8U2VsZWN0b3JzPiA9IERFRkFVTFRfU0VMRUNUT1JTXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgeyBlbGVtZW50cywgc2VsZWN0b3JzOiBhbGxTZWxlY3RvcnMgfSA9IHNldHVwTGlzdFRlc3QoXG4gICAgYXNzZXJ0LFxuICAgIHNlbGVjdG9yc1xuICApO1xuICBjb25zdCBtdWx0aSA9IGVsZW1lbnRzLmxpc3QuZ2V0QXR0cmlidXRlKCdhcmlhLW11bHRpc2VsZWN0YWJsZScpO1xuXG4gIGF3YWl0IChtdWx0aVxuICAgID8gdGVzdExpc3RGb3JLZXlib2FyZE11bHRpU2VsZWN0aW9uKGFzc2VydCwgZWxlbWVudHMsIGFsbFNlbGVjdG9ycylcbiAgICA6IHRlc3RMaXN0Rm9yS2V5Ym9hcmRTaW5nbGVTZWxlY3Rpb24oYXNzZXJ0LCBlbGVtZW50cywgYWxsU2VsZWN0b3JzKSk7XG59XG5cbi8vXG4vLyBNT1VTRVxuLy9cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRlc3RMaXN0TW91c2VOYXZpZ2F0aW9uKFxuICBhc3NlcnQ6IEFzc2VydCxcbiAgc2VsZWN0b3JzOiBQYXJ0aWFsPFNlbGVjdG9ycz4gPSBERUZBVUxUX1NFTEVDVE9SU1xuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHsgZWxlbWVudHMsIHNlbGVjdG9yczogYWxsU2VsZWN0b3JzIH0gPSBzZXR1cExpc3RUZXN0KFxuICAgIGFzc2VydCxcbiAgICBzZWxlY3RvcnNcbiAgKTtcblxuICBjb25zdCB7IGxpc3QgfSA9IGVsZW1lbnRzO1xuICBhd2FpdCB0ZXN0TGlzdGJveE1vdXNlTmF2aWdhdGlvbihcbiAgICBhc3NlcnQsXG4gICAge1xuICAgICAgbGlzdFxuICAgIH0sXG4gICAge1xuICAgICAgb3B0aW9uOiBhbGxTZWxlY3RvcnMub3B0aW9uXG4gICAgfVxuICApO1xufVxuXG5hc3luYyBmdW5jdGlvbiB0ZXN0TGlzdEZvck1vdXNlU2luZ2xlU2VsZWN0aW9uKFxuICBhc3NlcnQ6IEFzc2VydCxcbiAgZWxlbWVudHM6IEVsZW1lbnRzLFxuICBzZWxlY3RvcnM6IFNlbGVjdG9yc1xuKSB7XG4gIGNvbnN0IHsgdHJpZ2dlciwgbGlzdCB9ID0gZWxlbWVudHM7XG4gIGF3YWl0IHRlc3RMaXN0Ym94Rm9yTW91c2VTaW5nbGVTZWxlY3Rpb24oXG4gICAgYXNzZXJ0LFxuICAgIHtcbiAgICAgIHRhcmdldDogdHJpZ2dlcixcbiAgICAgIGxpc3RcbiAgICB9LFxuICAgIHtcbiAgICAgIG9wdGlvbjogc2VsZWN0b3JzLm9wdGlvblxuICAgIH1cbiAgKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gdGVzdExpc3RGb3JNb3VzZU11bHRpU2VsZWN0aW9uKFxuICBhc3NlcnQ6IEFzc2VydCxcbiAgZWxlbWVudHM6IEVsZW1lbnRzLFxuICBzZWxlY3RvcnM6IFNlbGVjdG9yc1xuKSB7XG4gIGNvbnN0IHsgdHJpZ2dlciwgbGlzdCB9ID0gZWxlbWVudHM7XG4gIGF3YWl0IHRlc3RMaXN0Ym94Rm9yTW91c2VNdWx0aVNlbGVjdGlvbihcbiAgICBhc3NlcnQsXG4gICAge1xuICAgICAgdGFyZ2V0OiB0cmlnZ2VyLFxuICAgICAgbGlzdFxuICAgIH0sXG4gICAge1xuICAgICAgb3B0aW9uOiBzZWxlY3RvcnMub3B0aW9uXG4gICAgfVxuICApO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGVzdExpc3RNb3VzZVNlbGVjdGlvbihcbiAgYXNzZXJ0OiBBc3NlcnQsXG4gIHNlbGVjdG9yczogUGFydGlhbDxTZWxlY3RvcnM+ID0gREVGQVVMVF9TRUxFQ1RPUlNcbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB7IGVsZW1lbnRzLCBzZWxlY3RvcnM6IGFsbFNlbGVjdG9ycyB9ID0gc2V0dXBMaXN0VGVzdChcbiAgICBhc3NlcnQsXG4gICAgc2VsZWN0b3JzXG4gICk7XG4gIGNvbnN0IG11bHRpID0gZWxlbWVudHMubGlzdC5nZXRBdHRyaWJ1dGUoJ2FyaWEtbXVsdGlzZWxlY3RhYmxlJyk7XG5cbiAgYXdhaXQgKG11bHRpXG4gICAgPyB0ZXN0TGlzdEZvck1vdXNlTXVsdGlTZWxlY3Rpb24oYXNzZXJ0LCBlbGVtZW50cywgYWxsU2VsZWN0b3JzKVxuICAgIDogdGVzdExpc3RGb3JNb3VzZVNpbmdsZVNlbGVjdGlvbihhc3NlcnQsIGVsZW1lbnRzLCBhbGxTZWxlY3RvcnMpKTtcbn1cbiJdfQ==