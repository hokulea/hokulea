import { triggerKeyEvent, click } from '@ember/test-helpers';
function getOptions(list, selector) {
    return [...list.querySelectorAll(selector)];
}
//
// KEYBOARD
//
export async function testListboxKeyboardNavigation(assert, elements, selectors) {
    const { target, list } = elements;
    const options = getOptions(list, selectors.option);
    const [first, second, last] = options;
    assert.dom(first).hasAria('current', 'true', 'First option is activated');
    await triggerKeyEvent(target, 'keydown', 'ArrowDown');
    assert
        .dom(second)
        .hasAria('current', 'true', 'ArrowDown activates second option');
    assert
        .dom(first)
        .doesNotHaveAria('current', '... and deactivates first option');
    await triggerKeyEvent(target, 'keydown', 'ArrowDown');
    assert
        .dom(last)
        .hasAria('current', 'true', 'ArrowDown activates last option');
    await triggerKeyEvent(target, 'keydown', 'Home');
    assert.dom(first).hasAria('current', 'true', 'Home activates first option');
    await triggerKeyEvent(target, 'keydown', 'End');
    assert.dom(last).hasAria('current', 'true', 'End activates last option');
}
export async function testListboxForKeyboardSingleSelection(assert, elements, selectors) {
    const { target, list } = elements;
    const options = getOptions(list, selectors.option);
    const [first, second, last] = options;
    assert.dom(first).hasAria('current', 'true', 'First option is activated');
    assert.dom(first).hasAria('selected', 'true', '... and selected');
    await triggerKeyEvent(target, 'keydown', 'ArrowDown');
    assert
        .dom(second)
        .hasAria('selected', 'true', 'ArrowDown selects second option');
    assert
        .dom(first)
        .doesNotHaveAria('selected', '... and deselects first option');
    await triggerKeyEvent(target, 'keydown', 'ArrowDown');
    assert.dom(last).hasAria('selected', 'true', 'ArrowDown selects last option');
    await triggerKeyEvent(target, 'keydown', 'Home');
    assert.dom(first).hasAria('selected', 'true', 'Home selects first option');
    await triggerKeyEvent(target, 'keydown', 'End');
    assert.dom(last).hasAria('selected', 'true', 'End selects last option');
}
export async function testListboxForKeyboardMultiSelection(assert, elements, selectors) {
    const { target, list } = elements;
    const options = getOptions(list, selectors.option);
    const [first, second, last] = options;
    assert.dom(first).hasAria('current', 'true', 'First option is activated');
    assert.dom(first).doesNotHaveAria('selected', '... and not selected');
    await triggerKeyEvent(target, 'keydown', ' ');
    assert.dom(first).hasAria('selected', 'true', 'SPACE selects first option');
    await triggerKeyEvent(target, 'keydown', ' ');
    assert.dom(first).doesNotHaveAria('selected', 'SPACE deselects first option');
    await triggerKeyEvent(target, 'keydown', ' ');
    assert.dom(first).hasAria('selected', 'true', 'SPACE selects first option');
    await triggerKeyEvent(target, 'keydown', 'ArrowDown');
    await triggerKeyEvent(target, 'keydown', ' ');
    assert
        .dom(second)
        .hasAria('selected', 'true', 'ArrowDown + SPACE selects second option');
    assert
        .dom(first)
        .hasAria('selected', 'true', '... and first option still selected');
    await triggerKeyEvent(target, 'keydown', 'End');
    await triggerKeyEvent(target, 'keydown', ' ');
    assert
        .dom(last)
        .hasAria('selected', 'true', 'End + SPACE selects last option');
    assert
        .dom(first)
        .hasAria('selected', 'true', '... and first option still selected');
    assert
        .dom(second)
        .hasAria('selected', 'true', '... and second option still selected');
    await triggerKeyEvent(target, 'keydown', 'Home');
    await triggerKeyEvent(target, 'keydown', ' ');
    assert
        .dom(first)
        .doesNotHaveAria('selected', 'Home + SPACE deselects first option');
    assert
        .dom(second)
        .hasAria('selected', 'true', '... and second option still selected');
    assert
        .dom(last)
        .hasAria('selected', 'true', '... and last option still selected');
    await triggerKeyEvent(target, 'keydown', 'ArrowDown');
    await triggerKeyEvent(target, 'keydown', ' ');
    assert
        .dom(second)
        .doesNotHaveAria('selected', 'ArrowDown + SPACE deselects second option');
    await triggerKeyEvent(target, 'keydown', 'ArrowDown');
    await triggerKeyEvent(target, 'keydown', ' ');
    assert
        .dom(last)
        .doesNotHaveAria('selected', 'ArrowDown + SPACE deselects last option');
    await triggerKeyEvent(target, 'keydown', 'KeyA', { metaKey: true });
    assert.dom(first).hasAria('selected', 'true', 'Meta + A selects all');
    assert.dom(second).hasAria('selected', 'true', '... second option selected');
    assert.dom(last).hasAria('selected', 'true', '... last option selected');
}
//
// MOUSE
//
export async function testListboxMouseNavigation(assert, elements, selectors) {
    const { list } = elements;
    const options = getOptions(list, selectors.option);
    const [first, second, last] = options;
    await click(first);
    assert
        .dom(first)
        .hasAria('current', 'true', 'Clicking first option activates it');
    await click(second);
    assert
        .dom(second)
        .hasAria('current', 'true', 'Clicking second option activates it');
    assert
        .dom(first)
        .doesNotHaveAria('current', '... and deactivates first option');
    await click(last);
    assert
        .dom(last)
        .hasAria('current', 'true', 'Clicking last option activates it');
    assert
        .dom(second)
        .doesNotHaveAria('current', '... and deactivates second option');
}
export async function testListboxForMouseSingleSelection(assert, elements, selectors) {
    const { list } = elements;
    const options = getOptions(list, selectors.option);
    const [first, second, last] = options;
    await click(first);
    assert
        .dom(first)
        .hasAria('selected', 'true', 'Clicking first option selects it');
    await click(second);
    assert
        .dom(second)
        .hasAria('selected', 'true', 'Clicking second option selects it');
    assert
        .dom(first)
        .doesNotHaveAria('selected', '... and deselects first option');
    await click(last);
    assert
        .dom(last)
        .hasAria('selected', 'true', 'Clicking last option selects it');
    assert
        .dom(second)
        .doesNotHaveAria('selected', '... and deselects second option');
}
export async function testListboxForMouseMultiSelection(assert, elements, selectors) {
    const { list } = elements;
    const options = getOptions(list, selectors.option);
    const [first, second, last] = options;
    await click(first);
    assert
        .dom(first)
        .hasAria('selected', 'true', 'Clicking first option selects it');
    await click(first, { metaKey: true });
    assert
        .dom(first)
        .doesNotHaveAria('selected', 'Clicking first option deselects it');
    await click(first);
    assert
        .dom(first)
        .hasAria('selected', 'true', 'Clicking first option selects it');
    await click(second, { metaKey: true });
    assert
        .dom(second)
        .hasAria('selected', 'true', 'Clicking second option (with meta) selects it');
    assert
        .dom(second)
        .hasAria('selected', 'true', '... and first option still selected');
    await click(last, { metaKey: true });
    assert
        .dom(last)
        .hasAria('selected', 'true', 'Clicking last option (with meta) selects it');
    assert
        .dom(first)
        .hasAria('selected', 'true', '... and first option still selected');
    assert
        .dom(second)
        .hasAria('selected', 'true', '... and second option still selected');
    await click(first, { metaKey: true });
    assert
        .dom(first)
        .doesNotHaveAria('selected', 'Clicking first option (with meta) deselects it');
    assert
        .dom(second)
        .hasAria('selected', 'true', '... and second option still selected');
    assert
        .dom(last)
        .hasAria('selected', 'true', '... and last option still selected');
    await click(second, { metaKey: true });
    assert
        .dom(second)
        .doesNotHaveAria('selected', 'Clicking second option (with meta) deselects it');
    await click(last, { metaKey: true });
    assert
        .dom(last)
        .doesNotHaveAria('selected', 'Clicking last option (with meta) deselects it');
    await click(first);
    assert
        .dom(first)
        .hasAria('selected', 'true', 'Clicking first option selects it');
    await click(last, { shiftKey: true });
    assert
        .dom(last)
        .hasAria('selected', 'true', 'Clicking last option (with shift) selects it');
    assert.dom(second).hasAria('selected', 'true', '... and second option, too');
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdGJveC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImxpc3Rib3gudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLGVBQWUsRUFBRSxLQUFLLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUU3RCxTQUFTLFVBQVUsQ0FBQyxJQUFpQixFQUFFLFFBQWdCO0lBQ3JELE9BQU8sQ0FBQyxHQUFHLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO0FBQzlDLENBQUM7QUFFRCxFQUFFO0FBQ0YsV0FBVztBQUNYLEVBQUU7QUFFRixNQUFNLENBQUMsS0FBSyxVQUFVLDZCQUE2QixDQUNqRCxNQUFjLEVBQ2QsUUFHQyxFQUNELFNBRUM7SUFFRCxNQUFNLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxHQUFHLFFBQVEsQ0FBQztJQUNsQyxNQUFNLE9BQU8sR0FBRyxVQUFVLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNuRCxNQUFNLENBQUMsS0FBSyxFQUFFLE1BQU0sRUFBRSxJQUFJLENBQUMsR0FBRyxPQUFPLENBQUM7SUFFdEMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsU0FBUyxFQUFFLE1BQU0sRUFBRSwyQkFBMkIsQ0FBQyxDQUFDO0lBRTFFLE1BQU0sZUFBZSxDQUFDLE1BQU0sRUFBRSxTQUFTLEVBQUUsV0FBVyxDQUFDLENBQUM7SUFFdEQsTUFBTTtTQUNILEdBQUcsQ0FBQyxNQUFNLENBQUM7U0FDWCxPQUFPLENBQUMsU0FBUyxFQUFFLE1BQU0sRUFBRSxtQ0FBbUMsQ0FBQyxDQUFDO0lBQ25FLE1BQU07U0FDSCxHQUFHLENBQUMsS0FBSyxDQUFDO1NBQ1YsZUFBZSxDQUFDLFNBQVMsRUFBRSxrQ0FBa0MsQ0FBQyxDQUFDO0lBRWxFLE1BQU0sZUFBZSxDQUFDLE1BQU0sRUFBRSxTQUFTLEVBQUUsV0FBVyxDQUFDLENBQUM7SUFF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RSxDQUFDLENBQUM7SUFDdkMsTUFBTTtTQUNILEdBQUcsQ0FBQyxNQUFNLENBQUM7U0FDWCxlQUFlLENBQ2QsVUFBVSxFQUNWLGlEQUFpRCxDQUNsRCxDQUFDO0lBRUosTUFBTSxLQUFLLENBQUMsSUFBSSxFQUFFLEVBQUUsT0FBTyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUM7SUFDckMsTUFBTTtTQUNILEdBQUcsQ0FBQyxJQUFJLENBQUM7U0FDVCxlQUFlLENBQ2QsVUFBVSxFQUNWLCtDQUErQyxDQUNoRCxDQUFDO0lBRUosTUFBTSxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDbkIsTUFBTTtTQUNILEdBQUcsQ0FBQyxLQUFLLENBQUM7U0FDVixPQUFPLENBQUMsVUFBVSxFQUFFLE1BQU0sRUFBRSxrQ0FBa0MsQ0FBQyxDQUFDO0lBRW5FLE1BQU0sS0FBSyxDQUFDLElBQUksRUFBRSxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ3RDLE1BQU07U0FDSCxHQUFHLENBQUMsSUFBSSxDQUFDO1NBQ1QsT0FBTyxDQUNOLFVBQVUsRUFDVixNQUFNLEVBQ04sOENBQThDLENBQy9DLENBQUM7SUFFSixNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFVLEVBQUUsTUFBTSxFQUFFLDRCQUE0QixDQUFDLENBQUM7QUFDL0UsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRyaWdnZXJLZXlFdmVudCwgY2xpY2sgfSBmcm9tICdAZW1iZXIvdGVzdC1oZWxwZXJzJztcblxuZnVuY3Rpb24gZ2V0T3B0aW9ucyhsaXN0OiBIVE1MRWxlbWVudCwgc2VsZWN0b3I6IHN0cmluZykge1xuICByZXR1cm4gWy4uLmxpc3QucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcildO1xufVxuXG4vL1xuLy8gS0VZQk9BUkRcbi8vXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXN0TGlzdGJveEtleWJvYXJkTmF2aWdhdGlvbihcbiAgYXNzZXJ0OiBBc3NlcnQsXG4gIGVsZW1lbnRzOiB7XG4gICAgdGFyZ2V0OiBIVE1MRWxlbWVudDtcbiAgICBsaXN0OiBIVE1MRWxlbWVudDtcbiAgfSxcbiAgc2VsZWN0b3JzOiB7XG4gICAgb3B0aW9uOiBzdHJpbmc7XG4gIH1cbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB7IHRhcmdldCwgbGlzdCB9ID0gZWxlbWVudHM7XG4gIGNvbnN0IG9wdGlvbnMgPSBnZXRPcHRpb25zKGxpc3QsIHNlbGVjdG9ycy5vcHRpb24pO1xuICBjb25zdCBbZmlyc3QsIHNlY29uZCwgbGFzdF0gPSBvcHRpb25zO1xuXG4gIGFzc2VydC5kb20oZmlyc3QpLmhhc0FyaWEoJ2N1cnJlbnQnLCAndHJ1ZScsICdGaXJzdCBvcHRpb24gaXMgYWN0aXZhdGVkJyk7XG5cbiAgYXdhaXQgdHJpZ2dlcktleUV2ZW50KHRhcmdldCwgJ2tleWRvd24nLCAnQXJyb3dEb3duJyk7XG5cbiAgYXNzZXJ0XG4gICAgLmRvbShzZWNvbmQpXG4gICAgLmhhc0FyaWEoJ2N1cnJlbnQnLCAndHJ1ZScsICdBcnJvd0Rvd24gYWN0aXZhdGVzIHNlY29uZCBvcHRpb24nKTtcbiAgYXNzZXJ0XG4gICAgLmRvbShmaXJzdClcbiAgICAuZG9lc05vdEhhdmVBcmlhKCdjdXJyZW50JywgJy4uLiBhbmQgZGVhY3RpdmF0ZXMgZmlyc3Qgb3B0aW9uJyk7XG5cbiAgYXdhaXQgdHJpZ2dlcktleUV2ZW50KHRhcmdldCwgJ2tleWRvd24nLCAnQXJyb3dEb3duJyk7XG5cbiAgYXNzZXJ0XG4gICAgLmRvbShsYXN0KVxuICAgIC5oYXNBcmlhKCdjdXJyZW50JywgJ3RydWUnLCAnQXJyb3dEb3duIGFjdGl2YXRlcyBsYXN0IG9wdGlvbicpO1xuXG4gIGF3YWl0IHRyaWdnZXJLZXlFdmVudCh0YXJnZXQsICdrZXlkb3duJywgJ0hvbWUnKTtcbiAgYXNzZXJ0LmRvbShmaXJzdCkuaGFzQXJpYSgnY3VycmVudCcsICd0cnVlJywgJ0hvbWUgYWN0aXZhdGVzIGZpcnN0IG9wdGlvbicpO1xuXG4gIGF3YWl0IHRyaWdnZXJLZXlFdmVudCh0YXJnZXQsICdrZXlkb3duJywgJ0VuZCcpO1xuICBhc3NlcnQuZG9tKGxhc3QpLmhhc0FyaWEoJ2N1cnJlbnQnLCAndHJ1ZScsICdFbmQgYWN0aXZhdGVzIGxhc3Qgb3B0aW9uJyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXN0TGlzdGJveEZvcktleWJvYXJkU2luZ2xlU2VsZWN0aW9uKFxuICBhc3NlcnQ6IEFzc2VydCxcbiAgZWxlbWVudHM6IHtcbiAgICB0YXJnZXQ6IEhUTUxFbGVtZW50O1xuICAgIGxpc3Q6IEhUTUxFbGVtZW50O1xuICB9LFxuICBzZWxlY3RvcnM6IHtcbiAgICBvcHRpb246IHN0cmluZztcbiAgfVxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHsgdGFyZ2V0LCBsaXN0IH0gPSBlbGVtZW50cztcbiAgY29uc3Qgb3B0aW9ucyA9IGdldE9wdGlvbnMobGlzdCwgc2VsZWN0b3JzLm9wdGlvbik7XG4gIGNvbnN0IFtmaXJzdCwgc2Vjb25kLCBsYXN0XSA9IG9wdGlvbnM7XG5cbiAgYXNzZXJ0LmRvbShmaXJzdCkuaGFzQXJpYSgnY3VycmVudCcsICd0cnVlJywgJ0ZpcnN0IG9wdGlvbiBpcyBhY3RpdmF0ZWQnKTtcbiAgYXNzZXJ0LmRvbShmaXJzdCkuaGFzQXJpYSgnc2VsZWN0ZWQnLCAndHJ1ZScsICcuLi4gYW5kIHNlbGVjdGVkJyk7XG5cbiAgYXdhaXQgdHJpZ2dlcktleUV2ZW50KHRhcmdldCwgJ2tleWRvd24nLCAnQXJyb3dEb3duJyk7XG4gIGFzc2VydFxuICAgIC5kb20oc2Vjb25kKVxuICAgIC5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJ0Fycm93RG93biBzZWxlY3RzIHNlY29uZCBvcHRpb24nKTtcbiAgYXNzZXJ0XG4gICAgLmRvbShmaXJzdClcbiAgICAuZG9lc05vdEhhdmVBcmlhKCdzZWxlY3RlZCcsICcuLi4gYW5kIGRlc2VsZWN0cyBmaXJzdCBvcHRpb24nKTtcblxuICBhd2FpdCB0cmlnZ2VyS2V5RXZlbnQodGFyZ2V0LCAna2V5ZG93bicsICdBcnJvd0Rvd24nKTtcbiAgYXNzZXJ0LmRvbShsYXN0KS5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJ0Fycm93RG93biBzZWxlY3RzIGxhc3Qgb3B0aW9uJyk7XG5cbiAgYXdhaXQgdHJpZ2dlcktleUV2ZW50KHRhcmdldCwgJ2tleWRvd24nLCAnSG9tZScpO1xuICBhc3NlcnQuZG9tKGZpcnN0KS5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJ0hvbWUgc2VsZWN0cyBmaXJzdCBvcHRpb24nKTtcblxuICBhd2FpdCB0cmlnZ2VyS2V5RXZlbnQodGFyZ2V0LCAna2V5ZG93bicsICdFbmQnKTtcbiAgYXNzZXJ0LmRvbShsYXN0KS5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJ0VuZCBzZWxlY3RzIGxhc3Qgb3B0aW9uJyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB0ZXN0TGlzdGJveEZvcktleWJvYXJkTXVsdGlTZWxlY3Rpb24oXG4gIGFzc2VydDogQXNzZXJ0LFxuICBlbGVtZW50czoge1xuICAgIHRhcmdldDogSFRNTEVsZW1lbnQ7XG4gICAgbGlzdDogSFRNTEVsZW1lbnQ7XG4gIH0sXG4gIHNlbGVjdG9yczoge1xuICAgIG9wdGlvbjogc3RyaW5nO1xuICB9XG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgeyB0YXJnZXQsIGxpc3QgfSA9IGVsZW1lbnRzO1xuICBjb25zdCBvcHRpb25zID0gZ2V0T3B0aW9ucyhsaXN0LCBzZWxlY3RvcnMub3B0aW9uKTtcbiAgY29uc3QgW2ZpcnN0LCBzZWNvbmQsIGxhc3RdID0gb3B0aW9ucztcblxuICBhc3NlcnQuZG9tKGZpcnN0KS5oYXNBcmlhKCdjdXJyZW50JywgJ3RydWUnLCAnRmlyc3Qgb3B0aW9uIGlzIGFjdGl2YXRlZCcpO1xuICBhc3NlcnQuZG9tKGZpcnN0KS5kb2VzTm90SGF2ZUFyaWEoJ3NlbGVjdGVkJywgJy4uLiBhbmQgbm90IHNlbGVjdGVkJyk7XG5cbiAgYXdhaXQgdHJpZ2dlcktleUV2ZW50KHRhcmdldCwgJ2tleWRvd24nLCAnICcpO1xuICBhc3NlcnQuZG9tKGZpcnN0KS5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJ1NQQUNFIHNlbGVjdHMgZmlyc3Qgb3B0aW9uJyk7XG5cbiAgYXdhaXQgdHJpZ2dlcktleUV2ZW50KHRhcmdldCwgJ2tleWRvd24nLCAnICcpO1xuICBhc3NlcnQuZG9tKGZpcnN0KS5kb2VzTm90SGF2ZUFyaWEoJ3NlbGVjdGVkJywgJ1NQQUNFIGRlc2VsZWN0cyBmaXJzdCBvcHRpb24nKTtcblxuICBhd2FpdCB0cmlnZ2VyS2V5RXZlbnQodGFyZ2V0LCAna2V5ZG93bicsICcgJyk7XG4gIGFzc2VydC5kb20oZmlyc3QpLmhhc0FyaWEoJ3NlbGVjdGVkJywgJ3RydWUnLCAnU1BBQ0Ugc2VsZWN0cyBmaXJzdCBvcHRpb24nKTtcblxuICBhd2FpdCB0cmlnZ2VyS2V5RXZlbnQodGFyZ2V0LCAna2V5ZG93bicsICdBcnJvd0Rvd24nKTtcbiAgYXdhaXQgdHJpZ2dlcktleUV2ZW50KHRhcmdldCwgJ2tleWRvd24nLCAnICcpO1xuICBhc3NlcnRcbiAgICAuZG9tKHNlY29uZClcbiAgICAuaGFzQXJpYSgnc2VsZWN0ZWQnLCAndHJ1ZScsICdBcnJvd0Rvd24gKyBTUEFDRSBzZWxlY3RzIHNlY29uZCBvcHRpb24nKTtcbiAgYXNzZXJ0XG4gICAgLmRvbShmaXJzdClcbiAgICAuaGFzQXJpYSgnc2VsZWN0ZWQnLCAndHJ1ZScsICcuLi4gYW5kIGZpcnN0IG9wdGlvbiBzdGlsbCBzZWxlY3RlZCcpO1xuXG4gIGF3YWl0IHRyaWdnZXJLZXlFdmVudCh0YXJnZXQsICdrZXlkb3duJywgJ0VuZCcpO1xuICBhd2FpdCB0cmlnZ2VyS2V5RXZlbnQodGFyZ2V0LCAna2V5ZG93bicsICcgJyk7XG4gIGFzc2VydFxuICAgIC5kb20obGFzdClcbiAgICAuaGFzQXJpYSgnc2VsZWN0ZWQnLCAndHJ1ZScsICdFbmQgKyBTUEFDRSBzZWxlY3RzIGxhc3Qgb3B0aW9uJyk7XG4gIGFzc2VydFxuICAgIC5kb20oZmlyc3QpXG4gICAgLmhhc0FyaWEoJ3NlbGVjdGVkJywgJ3RydWUnLCAnLi4uIGFuZCBmaXJzdCBvcHRpb24gc3RpbGwgc2VsZWN0ZWQnKTtcbiAgYXNzZXJ0XG4gICAgLmRvbShzZWNvbmQpXG4gICAgLmhhc0FyaWEoJ3NlbGVjdGVkJywgJ3RydWUnLCAnLi4uIGFuZCBzZWNvbmQgb3B0aW9uIHN0aWxsIHNlbGVjdGVkJyk7XG5cbiAgYXdhaXQgdHJpZ2dlcktleUV2ZW50KHRhcmdldCwgJ2tleWRvd24nLCAnSG9tZScpO1xuICBhd2FpdCB0cmlnZ2VyS2V5RXZlbnQodGFyZ2V0LCAna2V5ZG93bicsICcgJyk7XG5cbiAgYXNzZXJ0XG4gICAgLmRvbShmaXJzdClcbiAgICAuZG9lc05vdEhhdmVBcmlhKCdzZWxlY3RlZCcsICdIb21lICsgU1BBQ0UgZGVzZWxlY3RzIGZpcnN0IG9wdGlvbicpO1xuICBhc3NlcnRcbiAgICAuZG9tKHNlY29uZClcbiAgICAuaGFzQXJpYSgnc2VsZWN0ZWQnLCAndHJ1ZScsICcuLi4gYW5kIHNlY29uZCBvcHRpb24gc3RpbGwgc2VsZWN0ZWQnKTtcbiAgYXNzZXJ0XG4gICAgLmRvbShsYXN0KVxuICAgIC5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJy4uLiBhbmQgbGFzdCBvcHRpb24gc3RpbGwgc2VsZWN0ZWQnKTtcblxuICBhd2FpdCB0cmlnZ2VyS2V5RXZlbnQodGFyZ2V0LCAna2V5ZG93bicsICdBcnJvd0Rvd24nKTtcbiAgYXdhaXQgdHJpZ2dlcktleUV2ZW50KHRhcmdldCwgJ2tleWRvd24nLCAnICcpO1xuICBhc3NlcnRcbiAgICAuZG9tKHNlY29uZClcbiAgICAuZG9lc05vdEhhdmVBcmlhKCdzZWxlY3RlZCcsICdBcnJvd0Rvd24gKyBTUEFDRSBkZXNlbGVjdHMgc2Vjb25kIG9wdGlvbicpO1xuXG4gIGF3YWl0IHRyaWdnZXJLZXlFdmVudCh0YXJnZXQsICdrZXlkb3duJywgJ0Fycm93RG93bicpO1xuICBhd2FpdCB0cmlnZ2VyS2V5RXZlbnQodGFyZ2V0LCAna2V5ZG93bicsICcgJyk7XG4gIGFzc2VydFxuICAgIC5kb20obGFzdClcbiAgICAuZG9lc05vdEhhdmVBcmlhKCdzZWxlY3RlZCcsICdBcnJvd0Rvd24gKyBTUEFDRSBkZXNlbGVjdHMgbGFzdCBvcHRpb24nKTtcblxuICBhd2FpdCB0cmlnZ2VyS2V5RXZlbnQodGFyZ2V0LCAna2V5ZG93bicsICdLZXlBJywgeyBtZXRhS2V5OiB0cnVlIH0pO1xuICBhc3NlcnQuZG9tKGZpcnN0KS5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJ01ldGEgKyBBIHNlbGVjdHMgYWxsJyk7XG4gIGFzc2VydC5kb20oc2Vjb25kKS5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJy4uLiBzZWNvbmQgb3B0aW9uIHNlbGVjdGVkJyk7XG4gIGFzc2VydC5kb20obGFzdCkuaGFzQXJpYSgnc2VsZWN0ZWQnLCAndHJ1ZScsICcuLi4gbGFzdCBvcHRpb24gc2VsZWN0ZWQnKTtcbn1cblxuLy9cbi8vIE1PVVNFXG4vL1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdGVzdExpc3Rib3hNb3VzZU5hdmlnYXRpb24oXG4gIGFzc2VydDogQXNzZXJ0LFxuICBlbGVtZW50czoge1xuICAgIGxpc3Q6IEhUTUxFbGVtZW50O1xuICB9LFxuICBzZWxlY3RvcnM6IHtcbiAgICBvcHRpb246IHN0cmluZztcbiAgfVxuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHsgbGlzdCB9ID0gZWxlbWVudHM7XG4gIGNvbnN0IG9wdGlvbnMgPSBnZXRPcHRpb25zKGxpc3QsIHNlbGVjdG9ycy5vcHRpb24pO1xuICBjb25zdCBbZmlyc3QsIHNlY29uZCwgbGFzdF0gPSBvcHRpb25zO1xuXG4gIGF3YWl0IGNsaWNrKGZpcnN0KTtcbiAgYXNzZXJ0XG4gICAgLmRvbShmaXJzdClcbiAgICAuaGFzQXJpYSgnY3VycmVudCcsICd0cnVlJywgJ0NsaWNraW5nIGZpcnN0IG9wdGlvbiBhY3RpdmF0ZXMgaXQnKTtcblxuICBhd2FpdCBjbGljayhzZWNvbmQpO1xuICBhc3NlcnRcbiAgICAuZG9tKHNlY29uZClcbiAgICAuaGFzQXJpYSgnY3VycmVudCcsICd0cnVlJywgJ0NsaWNraW5nIHNlY29uZCBvcHRpb24gYWN0aXZhdGVzIGl0Jyk7XG4gIGFzc2VydFxuICAgIC5kb20oZmlyc3QpXG4gICAgLmRvZXNOb3RIYXZlQXJpYSgnY3VycmVudCcsICcuLi4gYW5kIGRlYWN0aXZhdGVzIGZpcnN0IG9wdGlvbicpO1xuXG4gIGF3YWl0IGNsaWNrKGxhc3QpO1xuICBhc3NlcnRcbiAgICAuZG9tKGxhc3QpXG4gICAgLmhhc0FyaWEoJ2N1cnJlbnQnLCAndHJ1ZScsICdDbGlja2luZyBsYXN0IG9wdGlvbiBhY3RpdmF0ZXMgaXQnKTtcbiAgYXNzZXJ0XG4gICAgLmRvbShzZWNvbmQpXG4gICAgLmRvZXNOb3RIYXZlQXJpYSgnY3VycmVudCcsICcuLi4gYW5kIGRlYWN0aXZhdGVzIHNlY29uZCBvcHRpb24nKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRlc3RMaXN0Ym94Rm9yTW91c2VTaW5nbGVTZWxlY3Rpb24oXG4gIGFzc2VydDogQXNzZXJ0LFxuICBlbGVtZW50czoge1xuICAgIHRhcmdldDogSFRNTEVsZW1lbnQ7XG4gICAgbGlzdDogSFRNTEVsZW1lbnQ7XG4gIH0sXG4gIHNlbGVjdG9yczoge1xuICAgIG9wdGlvbjogc3RyaW5nO1xuICB9XG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgeyBsaXN0IH0gPSBlbGVtZW50cztcbiAgY29uc3Qgb3B0aW9ucyA9IGdldE9wdGlvbnMobGlzdCwgc2VsZWN0b3JzLm9wdGlvbik7XG4gIGNvbnN0IFtmaXJzdCwgc2Vjb25kLCBsYXN0XSA9IG9wdGlvbnM7XG5cbiAgYXdhaXQgY2xpY2soZmlyc3QpO1xuICBhc3NlcnRcbiAgICAuZG9tKGZpcnN0KVxuICAgIC5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJ0NsaWNraW5nIGZpcnN0IG9wdGlvbiBzZWxlY3RzIGl0Jyk7XG5cbiAgYXdhaXQgY2xpY2soc2Vjb25kKTtcbiAgYXNzZXJ0XG4gICAgLmRvbShzZWNvbmQpXG4gICAgLmhhc0FyaWEoJ3NlbGVjdGVkJywgJ3RydWUnLCAnQ2xpY2tpbmcgc2Vjb25kIG9wdGlvbiBzZWxlY3RzIGl0Jyk7XG4gIGFzc2VydFxuICAgIC5kb20oZmlyc3QpXG4gICAgLmRvZXNOb3RIYXZlQXJpYSgnc2VsZWN0ZWQnLCAnLi4uIGFuZCBkZXNlbGVjdHMgZmlyc3Qgb3B0aW9uJyk7XG5cbiAgYXdhaXQgY2xpY2sobGFzdCk7XG4gIGFzc2VydFxuICAgIC5kb20obGFzdClcbiAgICAuaGFzQXJpYSgnc2VsZWN0ZWQnLCAndHJ1ZScsICdDbGlja2luZyBsYXN0IG9wdGlvbiBzZWxlY3RzIGl0Jyk7XG4gIGFzc2VydFxuICAgIC5kb20oc2Vjb25kKVxuICAgIC5kb2VzTm90SGF2ZUFyaWEoJ3NlbGVjdGVkJywgJy4uLiBhbmQgZGVzZWxlY3RzIHNlY29uZCBvcHRpb24nKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHRlc3RMaXN0Ym94Rm9yTW91c2VNdWx0aVNlbGVjdGlvbihcbiAgYXNzZXJ0OiBBc3NlcnQsXG4gIGVsZW1lbnRzOiB7XG4gICAgdGFyZ2V0OiBIVE1MRWxlbWVudDtcbiAgICBsaXN0OiBIVE1MRWxlbWVudDtcbiAgfSxcbiAgc2VsZWN0b3JzOiB7XG4gICAgb3B0aW9uOiBzdHJpbmc7XG4gIH1cbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB7IGxpc3QgfSA9IGVsZW1lbnRzO1xuICBjb25zdCBvcHRpb25zID0gZ2V0T3B0aW9ucyhsaXN0LCBzZWxlY3RvcnMub3B0aW9uKTtcbiAgY29uc3QgW2ZpcnN0LCBzZWNvbmQsIGxhc3RdID0gb3B0aW9ucztcblxuICBhd2FpdCBjbGljayhmaXJzdCk7XG4gIGFzc2VydFxuICAgIC5kb20oZmlyc3QpXG4gICAgLmhhc0FyaWEoJ3NlbGVjdGVkJywgJ3RydWUnLCAnQ2xpY2tpbmcgZmlyc3Qgb3B0aW9uIHNlbGVjdHMgaXQnKTtcblxuICBhd2FpdCBjbGljayhmaXJzdCwgeyBtZXRhS2V5OiB0cnVlIH0pO1xuICBhc3NlcnRcbiAgICAuZG9tKGZpcnN0KVxuICAgIC5kb2VzTm90SGF2ZUFyaWEoJ3NlbGVjdGVkJywgJ0NsaWNraW5nIGZpcnN0IG9wdGlvbiBkZXNlbGVjdHMgaXQnKTtcblxuICBhd2FpdCBjbGljayhmaXJzdCk7XG4gIGFzc2VydFxuICAgIC5kb20oZmlyc3QpXG4gICAgLmhhc0FyaWEoJ3NlbGVjdGVkJywgJ3RydWUnLCAnQ2xpY2tpbmcgZmlyc3Qgb3B0aW9uIHNlbGVjdHMgaXQnKTtcblxuICBhd2FpdCBjbGljayhzZWNvbmQsIHsgbWV0YUtleTogdHJ1ZSB9KTtcbiAgYXNzZXJ0XG4gICAgLmRvbShzZWNvbmQpXG4gICAgLmhhc0FyaWEoXG4gICAgICAnc2VsZWN0ZWQnLFxuICAgICAgJ3RydWUnLFxuICAgICAgJ0NsaWNraW5nIHNlY29uZCBvcHRpb24gKHdpdGggbWV0YSkgc2VsZWN0cyBpdCdcbiAgICApO1xuXG4gIGFzc2VydFxuICAgIC5kb20oc2Vjb25kKVxuICAgIC5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJy4uLiBhbmQgZmlyc3Qgb3B0aW9uIHN0aWxsIHNlbGVjdGVkJyk7XG5cbiAgYXdhaXQgY2xpY2sobGFzdCwgeyBtZXRhS2V5OiB0cnVlIH0pO1xuXG4gIGFzc2VydFxuICAgIC5kb20obGFzdClcbiAgICAuaGFzQXJpYSgnc2VsZWN0ZWQnLCAndHJ1ZScsICdDbGlja2luZyBsYXN0IG9wdGlvbiAod2l0aCBtZXRhKSBzZWxlY3RzIGl0Jyk7XG4gIGFzc2VydFxuICAgIC5kb20oZmlyc3QpXG4gICAgLmhhc0FyaWEoJ3NlbGVjdGVkJywgJ3RydWUnLCAnLi4uIGFuZCBmaXJzdCBvcHRpb24gc3RpbGwgc2VsZWN0ZWQnKTtcbiAgYXNzZXJ0XG4gICAgLmRvbShzZWNvbmQpXG4gICAgLmhhc0FyaWEoJ3NlbGVjdGVkJywgJ3RydWUnLCAnLi4uIGFuZCBzZWNvbmQgb3B0aW9uIHN0aWxsIHNlbGVjdGVkJyk7XG5cbiAgYXdhaXQgY2xpY2soZmlyc3QsIHsgbWV0YUtleTogdHJ1ZSB9KTtcblxuICBhc3NlcnRcbiAgICAuZG9tKGZpcnN0KVxuICAgIC5kb2VzTm90SGF2ZUFyaWEoXG4gICAgICAnc2VsZWN0ZWQnLFxuICAgICAgJ0NsaWNraW5nIGZpcnN0IG9wdGlvbiAod2l0aCBtZXRhKSBkZXNlbGVjdHMgaXQnXG4gICAgKTtcbiAgYXNzZXJ0XG4gICAgLmRvbShzZWNvbmQpXG4gICAgLmhhc0FyaWEoJ3NlbGVjdGVkJywgJ3RydWUnLCAnLi4uIGFuZCBzZWNvbmQgb3B0aW9uIHN0aWxsIHNlbGVjdGVkJyk7XG4gIGFzc2VydFxuICAgIC5kb20obGFzdClcbiAgICAuaGFzQXJpYSgnc2VsZWN0ZWQnLCAndHJ1ZScsICcuLi4gYW5kIGxhc3Qgb3B0aW9uIHN0aWxsIHNlbGVjdGVkJyk7XG5cbiAgYXdhaXQgY2xpY2soc2Vjb25kLCB7IG1ldGFLZXk6IHRydWUgfSk7XG4gIGFzc2VydFxuICAgIC5kb20oc2Vjb25kKVxuICAgIC5kb2VzTm90SGF2ZUFyaWEoXG4gICAgICAnc2VsZWN0ZWQnLFxuICAgICAgJ0NsaWNraW5nIHNlY29uZCBvcHRpb24gKHdpdGggbWV0YSkgZGVzZWxlY3RzIGl0J1xuICAgICk7XG5cbiAgYXdhaXQgY2xpY2sobGFzdCwgeyBtZXRhS2V5OiB0cnVlIH0pO1xuICBhc3NlcnRcbiAgICAuZG9tKGxhc3QpXG4gICAgLmRvZXNOb3RIYXZlQXJpYShcbiAgICAgICdzZWxlY3RlZCcsXG4gICAgICAnQ2xpY2tpbmcgbGFzdCBvcHRpb24gKHdpdGggbWV0YSkgZGVzZWxlY3RzIGl0J1xuICAgICk7XG5cbiAgYXdhaXQgY2xpY2soZmlyc3QpO1xuICBhc3NlcnRcbiAgICAuZG9tKGZpcnN0KVxuICAgIC5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJ0NsaWNraW5nIGZpcnN0IG9wdGlvbiBzZWxlY3RzIGl0Jyk7XG5cbiAgYXdhaXQgY2xpY2sobGFzdCwgeyBzaGlmdEtleTogdHJ1ZSB9KTtcbiAgYXNzZXJ0XG4gICAgLmRvbShsYXN0KVxuICAgIC5oYXNBcmlhKFxuICAgICAgJ3NlbGVjdGVkJyxcbiAgICAgICd0cnVlJyxcbiAgICAgICdDbGlja2luZyBsYXN0IG9wdGlvbiAod2l0aCBzaGlmdCkgc2VsZWN0cyBpdCdcbiAgICApO1xuXG4gIGFzc2VydC5kb20oc2Vjb25kKS5oYXNBcmlhKCdzZWxlY3RlZCcsICd0cnVlJywgJy4uLiBhbmQgc2Vjb25kIG9wdGlvbiwgdG9vJyk7XG59XG4iXX0=